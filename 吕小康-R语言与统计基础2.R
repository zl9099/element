bootmean$replicates
qqPlot(bootmean$replicates)
qqPlot(bootmean$replicates)
qqPlot(bootmedian$replicates)
head(bootmean$replicates)
xxx <- boot(A$salary2012, mean(A$salary2012), 10000)
plot(bootmean, col = "lightblue")
par(mfrow = c(2, 2))
plot(bootmean, col = "lightblue")
qqPlot(bootmean$replicates)
plot(bootmedian, col = "lightyellow")
qqPlot(bootmedian$replicates)
par(mfrow = c(2, 2))
plot(bootmean, col = "lightblue")
plot(bootmedian, col = "lightyellow")
qqPlot(bootmean$replicates)
qqPlot(bootmedian$replicates)
plot(bootmean, col = "lightblue")
par(opar)
plot(bootmean, col = "lightblue")
plot(bootmean, col = "lightblue")
par(mfrow = c(1, 2))
plot(bootmean, col = "lightblue")
plot(bootmedian, col = "lightyellow")
par(opar)
plot(bootmean, col = "lightblue")
plot(bootmean, col = "lightblue")
pdf("pic-bootmean-by-resample.pdf")
plot(bootmean, col = "lightblue")
dev.off()
plot(bootmean, col = "lightgrey")
pdf("pic-bootmean-by-resample.pdf")
plot(bootmean, col = "lightgrey")
dev.off()
pdf("pic-bootmean-by-resample.pdf")
plot(bootmean, col = "lightblue")
dev.off()
pdf("pic-qqplot-bootmean.pdf")
qqPlot(bootmean$replicates)
dev.off()
pdf("pic-bootmedian-by-resample.pdf")
plot(bootmedian, col = "lightyellow")
dev.off()
pdf("pic-qqplot-bootmedian.pdf")
qqPlot(bootmedian$replicates)
dev.off()
pdf("pic-bootmedian-by-resample.pdf")
plot(bootmedian, col = "lightgreen")
dev.off()
?boot.ci
?CI.bca
CLEC <- with(Verizon, Time[Group == "CLEC"])
bootC <- bootstrap(CLEC, mean, seed = 0)
bootC2 <- bootstrap(CLEC, c(mean = mean(CLEC), sd = sd(CLEC)), seed = 0)
CI.percentile(bootC)
CI.t(bootC)
CI.bca(bootC)
CI.bootstrapT(bootC2)
?bootstrap
bootC <- bootstrap(CLEC, mean, seed = 0)
CI.t(bootC)
bootC <- bootstrap(CLEC, mean)
CI.t(bootC)
bootmedian <- bootstrap(A\$salary2012, median, 10000, seed = 2016)
bootmedian <- bootstrap(A$salary2012, median, 10000, seed = 2016)
bootmedian
bootmedian <- bootstrap(A$salary2012, median, 10000, seed = 2016)
bootmedian
CI.percentile(A$salary2012)
CI.t(A$salary2012)
CI.bca(A$salary2012)
CI.bootstrapT(A$salary2012)
CI.percentile(A$salary2012)
is.data.frame(A)
bootmean <- bootstrap(A$salary2012, mean, 10000, seed = 2016)
bootmean <- bootstrap(A$salary2012, mean, 10000, seed = 2016)
bootsd <- bootstrap(A$salary2012, sd, 1000, seed = 2016)
CI.percentile(bootmean)
CI.percentile(c(bootmean, bootsd))
CI.percentile(bootsd)
CI.percentile(bootmean)
CI.bootstrapT(bootmean)
CI.bootstrapT(bootmean)
CI.bca(bootmean)
CI.bootstrapT(bootmean)
?CI.bootstrapT
bootsd <- bootstrap(A$salary2012, statistics = c(mean(sd), sd(sd)), 10000, seed = 2016)
bootsd <- bootstrap(A$salary2012, statistics = c(mean = mean(sd), sd = sd(sd)), 10000, seed = 2016)
bootsd <- bootstrap(A$salary2012, statistics = c(mean = mean(A$salary2012), sd = sd(A$salary2012)), 10000, seed = 2016)
bootsd <- bootstrap(A$salary2012, sd, 10000, seed = 2016)
CI.bootstrapT(bootsd)
CI.percentile(bootsd)
CI.t(bootsd)
CI.bca(bootsd)
CI.bootstrapT(bootsd)
bootC2 <- bootstrap(CLEC, c(mean = mean(CLEC), sd = sd(CLEC)), seed = 0)
bootC2
CI.bootstrapT(bootC)
CI.bootstrapT(bootC2)
bootmean2 <- bootstrap(A$salary2012, statistic = c(mean = mean(A$salary2012), sd = sd(A$salary2012)), 10000, seed = 2016)
CI.bootstrapT(bootmean2)
CI.percentile(bootmean)
CI.t(bootmean)
CI.bca(bootmean)
CI.bootstrapT(bootmean2)
CI.bootstrapT(bootmean2)
CI.bootstrapT(bootC2)
bootmean2 <- bootstrap(A$salary2012, statistic = c(mean = mean(A$salary2012), sd = sd(A$salary2012)), 10000, seed = 2016)
CI.bootstrapT(bootmean2)
x = c(1: 10)
x1 = bootstrap(x, statistic = c(mean = mean(x), sd = sd(x)), 100, seed = 0)
CI.bootstrapT(x1)
bootmean2
A$salary2012
bootmean
bootmean2
sd(A$salary2012)
bootmean2 <- bootstrap(A$salary2012, statistic = c(mean = mean(A$salary2012), sd = sd(A$salary2012)), 10000, seed = 0)
bootmean2
bootmean2 <- bootstrap(A$salary2012, statistic = c(mean = mean(A$salary2012), sd = sd(A$salary2012)), R = 10000, seed = 0)
bootmean2
bootsd <- bootstrap(A$salary2012, sd, 10000, seed = 2016)
bootsd
CI.percentile(bootsd)
x = A$salary2012
x1 = bootstrap(x, statistic = c(mean = mean(x), sd = sd(x)), 100, seed = 0)
CI.bootstrapT(x1)
A$salary2012
bootmean2
original <- A$salary2012
original <- A$salary2012
S1 <- numeric(10000)
for (i in 1: 10000)
{
    set.seed(i)
    x <- sample(original, 10, replace = TRUE)
    S1[i]<- mean(x)
}
S2 <- numeric(10000)
for (i in 1: 10000)
{
    set.seed(i)
    x <- sample(salary$salary2012, 10, replace = FALSE)
    S2[i]<- mean(x)
}
S3 <- numeric(10000)
for (i in 1: 10000)
{
    set.seed(i)
    x <- sample(original, 10, replace = TRUE)
    S3[i]<- median(x)
}
S4 <- numeric(10000)
for (i in 1: 10000)
{
    set.seed(i)
    x <- sample(salary$salary2012, 10, replace = FALSE)
    S4[i]<- median(x)
}
par(mfrow=c(2,2))
hist(S1, breaks = 50, main = "Bootstrap Distribution of Mean", xlab = "Salary", xlim = c(0, 60000))


# abline(v=mean(S1), lwd=3,  lty=2, col="red")
abline(v=mean(original), lwd=3, lty = 2, col="red")
text(25000, 400, "sample mean \n  23100", pos = 4)

# text(30150, 500, "bootstrap mean = 30139.8", pos = 4)
mean(original)
mean(S1)
hist(S2, breaks = 50, main = "Sampling Distribution of Mean", xlab = "Salary", xlim = c(0, 60000))
abline(v=mean(salary$salary2012), lwd=3,  lty=2, col="red")
text(25500, 600, "population mean \n 23873.07", pos = 4)
mean(salary$salary2012)
hist(S3, breaks = 50, main = "Bootstrap Distribution of Median", xlab = "Salary", xlim = c(0, 60000))
abline(v=median(original), lwd=3,  lty=2, col="red")
text(20050, 2600, "sample median \n 20000", pos = 4)
median(original)
mean(S3)
hist(S4, breaks = 50, main = "Sampling Distribution of Median", xlab = "Salary", xlim = c(0, 60000))
abline(v=median(salary$salary2012), lwd=3,  lty=2, col="red")
text(20050, 920, "population median \n 20000", pos = 4)
bootmean2 <- bootstrap(original, statistic = c(mean = mean(original), sd = sd(original)), R = 10000, seed = 0)
CI.bootstrapT(bootmean2)
mean(salary$salary2012)
41239.06-14724.84
CI.percentile(bootmean)
35748.51-13500
CI.t(bootmean)
CI.bca(bootmean)
35748.51-13500
34050.57-12149.43
40099.71-14500
41239.06-14724.84
35748.51-13500
34050.57-12149.43
40099.71-14500
41239.06-14724.84
t.test(original)$conf.int
bootsd <- bootstrap(original, sd, 10000, seed = 2016)
CI.bca(bootsd)
CI.bca(bootsd)
CI.t(bootsd)
CI.percentile(bootsd)
bootsd <- bootstrap(original, sd, 10000, seed = 2016)
CI.percentile(bootsd)
CI.bca(bootmean)
CI.bca(bootsd)
?bootstrap
x <- rnorm(20, 10, 2)
t.test(x, alternative = "less")
t.test(x, mu = 10, alternative = "less")
mean(x)
t.test(x, mu = 11, alternative = "less")
t.test(x, mu = 12, alternative = "less")
t.test(x, mu = 10, alternative = "greater")
library(resample)
?permutationTest
set.seed(1)
A <- round(rnorm(7, 20, 5))
set.seed(2)
B <- round(rnorm(7, 17, 5))
set.seed(3)
C <- round(rnorm(7, 15, 5))
set.seed(4)
D <- round(rnorm(7, 13, 5))
permutationTest2(X, mean, Y)
set.seed(1)
X <- round(rnorm(7, 20, 5))
set.seed(2)
Y <- round(rnorm(7, 15, 5))
permutationTest2(X, mean, Y)
permutationTest2(data = X, statistics = mean, data2 = Y)
permutationTest2(data = X, statistic = mean, data2 = Y)
permutationTest2(data = X, statistic = mean, data2 = Y, alternative = "greater")
permutationTest2(data = X, statistic = mean, data2 = Y, alternative = "greater", paired = TRUE)
fat<-read.csv("fat.csv")
fat<-within(fat, {d<-Xray-UT})
library(resample)
fat$d
boostrap(fat$d, mean, R = 10000)
bootstrap(fat$d, mean, R = 10000)
bootmean <- bootstrap(fat$d, mean, R = 10000)
boot.d <- bootstrap(fat$d, mean, R = 10000)
plot(boot.d)
plot(boot.d, col = "lightblue")
library(qqPlot)
library(car)
qqPlot(boot.d)
qqPlot(boot.d$replicates)
CI.bca(boot.d)
library(resample)
fat$d
boot.d <- bootstrap(fat$d, mean, R = 10000)
pdf("pic-boot-fatdiff.pdf")
plot(boot.d, col = "lightblue")
dev.off()
library(car)
pdf("pic-qqplot-fatdiff.pdf")
qqPlot(boot.d$replicates)
dev.off()
CI.bca(boot.d)
qqPlot(boot.d$replicates, ylab = "diff quantile")
qqPlot(boot.d$replicates, ylab = "fat diff quantile")
pdf("pic-boot-fatdiff.pdf")
plot(boot.d, col = "lightblue")
dev.off()
library(car)
pdf("pic-qqplot-fatdiff.pdf")
qqPlot(boot.d$replicates, ylab = "fat differenc")
dev.off()
plot(boot.d, col = "blue")
pdf("pic-boot-fatdiff.pdf")
plot(boot.d, col = "blue")
dev.off()
pdf("pic-boot-fatdiff.pdf")
plot(boot.d, col = "lightblue")
dev.off()
library(car)
pdf("pic-qqplot-fatdiff.pdf")
qqPlot(boot.d$replicates, ylab = "fat differenc")
dev.off()
pdf("pic-qqplot-fatdiff.pdf")
qqPlot(boot.d$replicates, ylab = "fat difference")
dev.off()
pdf("pic-qqplot-fatdiff.pdf")
qqPlot(boot.d$replicates, ylab = "paired differences")
dev.off()
CI.bca(boot.d)
phone <- read.csv("phone.csv")
phone
bootstrap(phone$a, statistic = c(mean, sd), R = 10000)
bootstrap(phone$a, statistic = c(mean = mean(phone$a), sd = sd(phone$a)), R = 10000)
times <- phone$a
bootstrap(times, statistic = c(mean = mean(times), sd = sd(times)), R = 10000)
x = bootstrap(times, statistic = c(mean = mean(times), sd = sd(times)), R = 10000)
CI.bca(x)
?CI.bca
library(xtable)
xtable(CI.bca(x))
CI.bca(x, probs = c(0.005, 0.995))
xtable(CI.bca(x, probs = c(0.005, 0.995)))
plot(bootmean, col = "lightblue")
set.seed(1)
x <- round(rnorm(7, 20, 5))
set.seed(2)
y <- round(rnorm(7, 15, 5))
meandiff <- numeric(10000)
for (i in 1:1000)
{
    x1 < − sample(x, 7, replace = TRUE)
    y1 < − sample(y, 7, replace = TRUE)
    meandiff[i] < − mean(x1) - mean(y1)
}
meandiff <- numeric(10000)
for (i in 1:1000)
{
    x1 <- sample(x, 7, replace = TRUE)
    y1 <- sample(y, 7, replace = TRUE)
    meandiff[i] <- mean(x1) - mean(y1)
}
quantile(meandiff, probs = c(.025,0.975))
hist(meandiff)
hist(meandiff, breaks = 100)
meandiff <- numeric(10000)
for (i in 1:10000)
{
    x1 <- sample(x, 7, replace = TRUE)
    y1 <- sample(y, 7, replace = TRUE)
    meandiff[i] <- mean(x1) - mean(y1)
}
hist(meandiff, breaks = 100)
quantile(meandiff, probs = c(.025,0.975))
hist(meandiff, breaks = 100, main = "Histogram of Mean Differences", xlab = "Mean Differences")
abline(v = 0, lty = 2, lwd = 2, col = "red")
quantile(meandiff, probs = c(.025,0.975))
x <- round(rnorm(30, 20, 5))
set.seed(2)
y <- round(rnorm(30, 15, 5))
meandiff <- numeric(10000)
for (i in 1:10000)
{
    x1 <- sample(x, 7, replace = TRUE)
    y1 <- sample(y, 7, replace = TRUE)
    meandiff[i] <- mean(x1) - mean(y1)
}
hist(meandiff, breaks = 100, main = "Histogram of Mean Differences", xlab = "Mean Differences")
abline(v = 0, lty = 2, lwd = 2, col = "red")
quantile(meandiff, probs = c(.025,0.975))
bootstrap2(x, mean, y)
bootstrap2(x, mean, data2 = y)
boot.diff =  bootstrap2(x, mean, data2 = y)
CI.bca(boot.diff)
CI.percentile(boot.diff)
quantile(meandiff, probs = c(.025,0.975))
hist(boot.diff$replicates)
meandiff = function (x, y) {mean(x)-mean(y)}
meandiff
meandiff(x, y)
boot.diff =  bootstrap2(x, statistic = meandiff, data2 = y)
boot.diff =  bootstrap2(x, mean, data2 = y)
hist(boot.diff$replicates, breaks = 100)
set.seed(1)
x <- round(rnorm(30, 20, 5))
set.seed(2)
y <- round(rnorm(30, 15, 5))
meandiff <- numeric(10000)
for (i in 1:10000)
{
    x1 <- sample(x, 30, replace = TRUE)
    y1 <- sample(y, 30, replace = TRUE)
    meandiff[i] <- mean(x1) - mean(y1)
}
hist(meandiff, breaks = 100, main = "Histogram of Mean Differences", xlab = "Mean Differences")
abline(v = 0, lty = 2, lwd = 2, col = "red")
quantile(meandiff, probs = c(.025,0.975))
boot.diff =  bootstrap2(x, mean, data2 = y)
CI.percentile(boot.diff)
CI.bca(boot.diff)
quantile(meandiff, probs = c(.025,0.975))
CI.percentile(boot.diff)
abline(v = quantile(meandiff, probs = c(.025,0.975)), lty = 2, lwd = 2, col = "red")
hist(meandiff, breaks = 100, main = "Histogram of Mean Differences", xlab = "Mean Differences")
abline(v = quantile(meandiff, probs = c(.025,0.975)), lty = 2, lwd = 2, col = "red")
pdf("pic-inde-meandiff-boot.pdf")
hist(meandiff, breaks = 100, main = "Histogram of Mean Differences", xlab = "Mean Differences")
abline(v = quantile(meandiff, probs = c(.025,0.975)), lty = 2, lwd = 2, col = "red")
dev.off()
opar<-par(no.readonly=TRUE)
library(Cairo)
par(pin=c(2.8,2),mfrow=c(1,2))
x<-pretty(c(6,14),500)
myfun<-function(x){dnorm(x,mean=10,sd=1)}
curve(myfun,from=6.5,to=13.5,xlim=c(6,14),ylim=c(-
0.1,0.5),xlab=expression (italic(Z)),ylab="",lwd=1.5,axes=FALSE)
axis(1,at=c(5.5,14.5),label=c("",""),tck=0.01,pos=0)
text(8.46,-0.03,expression(italic(z[α/2])))
text(11.74,-0.03,expression(italic(z[α/2])))
cord.x <- c(6.5, seq(6.5, 8.36, 0.001),8.36)
cord.y <- c( 0, myfun(seq(6.5, 8.36, 0.001)),0)
polygon(cord.x,
cord.y,col="grey")
cord.x <- c(11.64, seq(11.64, 15, 0.001),15)
cord.y <- c( 0, myfun(seq(11.64, 15, 0.001)),0)
polygon(cord.x,
cord.y,col="grey")
text(7,0.05,expression(italic(α/2)))
text(13,0.05,expression(italic(α/2)))
segments(8.36, -0.055, 8.36, -0.1,lty=2)
segments(11.64, -0.055, 11.64, -0.1,lty=2)
text(10,-0.0775,"接受域",cex=0.7,family="KaiTi")
text(6.5,-0.0775,"拒绝域",cex=0.7,family="KaiTi")
text(13.5,-0.0775,"拒绝域",cex=0.7,family="KaiTi")
arrows(9.3,-0.0775,8.4,-0.0775,angle =30,lty=1,length=0.08)
arrows(10.7,-0.0775,11.6,-0.0775,angle =30,lty=1,length=0.08)
arrows(7.2,-0.0775,8.32,-0.0775,angle =30,lty=1,length=0.08)
arrows(12.8,-0.0775,11.68,-0.0775,angle =30,lty=1,length=0.08)
x<-pretty(c(6,14),500)
myfun<-function(x){dnorm(x,mean=10,sd=1)}
curve(myfun,from=6.5,to=13.5,xlim=c(6,14),ylim=c(-0.1,0.5),xlab=expression (italic(Z)),ylab="",lwd=1.5,axes=FALSE)
library(Cairo)
CairoPDF("双侧.pdf",family="Times New Roman")
opar<-par(no.readonly=TRUE)
par(pin=c(2.8,2),mfrow=c(1,2))
x<-pretty(c(6,14),500)
myfun<-function(x){dnorm(x,mean=10,sd=1)}
curve(myfun,from=6.5,to=13.5,xlim=c(6,14),ylim=c(-0.1,0.5),xlab=expression (italic(Z)),ylab="",lwd=1.5,axes=FALSE)
axis(1,at=c(5.5,14.5),label=c("",""),tck=0.01,pos=0)
text(8.46,-0.03,expression(italic(z[α/2])))
text(11.74,-0.03,expression(italic(z[α/2])))
cord.x <- c(6.5, seq(6.5, 8.36, 0.001),8.36)
cord.y <- c( 0, myfun(seq(6.5, 8.36, 0.001)),0)
polygon(cord.x,
cord.y,col="grey")
cord.x <- c(11.64, seq(11.64, 15, 0.001),15)
cord.y <- c( 0, myfun(seq(11.64, 15, 0.001)),0)
polygon(cord.x,
cord.y,col="grey")
text(7,0.05,expression(italic(α/2)))
text(13,0.05,expression(italic(α/2)))
segments(8.36, -0.055, 8.36, -0.1,lty=2)
segments(11.64, -0.055, 11.64, -0.1,lty=2)
text(10,-0.0775,"接受域",cex=0.7,family="KaiTi")
text(6.5,-0.0775,"拒绝域",cex=0.7,family="KaiTi")
text(13.5,-0.0775,"拒绝域",cex=0.7,family="KaiTi")
arrows(9.3,-0.0775,8.4,-0.0775,angle =30,lty=1,length=0.08)
arrows(10.7,-0.0775,11.6,-0.0775,angle =30,lty=1,length=0.08)
arrows(7.2,-0.0775,8.32,-0.0775,angle =30,lty=1,length=0.08)
arrows(12.8,-0.0775,11.68,-0.0775,angle =30,lty=1,length=0.08)
x<-pretty(c(6,14),500)
myfun<-function(x){dnorm(x,mean=10,sd=1)}
curve(myfun,from=6.5,to=13.5,xlim=c(6,14),ylim=c(-
0.1,0.5),xlab=expression (italic(bar
(X))),ylab="",lwd=1.5,axes=FALSE)
axis(1,at=c(5.5,14.5),label=c("",""),tck=0.01,pos=0)
text(8.46,-0.03,expression(italic(x[1])))
text(11.74,-0.03,expression(italic(x[2])))
cord.x <- c(6.5, seq(6.5, 8.36, 0.001),8.36)
cord.y <- c( 0, myfun(seq(6.5, 8.36, 0.001)),0)
polygon(cord.x,
cord.y,col="grey")
cord.x <- c(11.64, seq(11.64, 15, 0.001),15)
cord.y <- c( 0, myfun(seq(11.64, 15, 0.001)),0)
polygon(cord.x,
cord.y,col="grey")
text(7,0.05,expression(italic(α/2)))
text(13,0.05,expression(italic(α/2)))
segments(8.36, -0.055, 8.36, -0.1,lty=2)
segments(11.64, -0.055, 11.64, -0.1,lty=2)
text(10,-0.0775,"接受域",cex=0.7,family="KaiTi")
text(6.5,-0.0775,"拒绝域",cex=0.7,family="KaiTi")
text(13.5,-0.0775,"拒绝域",cex=0.7,family="KaiTi")
arrows(9.3,-0.0775,8.4,-0.0775,angle =30,lty=1,length=0.08)
arrows(10.7,-0.0775,11.6,-0.0775,angle =30,lty=1,length=0.08)
arrows(7.2,-0.0775,8.32,-0.0775,angle =30,lty=1,length=0.08)
arrows(12.8,-0.0775,11.68,-0.0775,angle =30,lty=1,length=0.08)
par(opar)
title("Two-Sided Test",family="Times New Roman")
dev.off
scores<-read.csv("test.scores.csv")
scores
t.test(scores$A, scores$B,paired = T, conf.level = 0.90)$conf
library(tidyr)
memeda<-array(dim=c(10000,2))
colnames(memeda)<-c("F","e-a")
for (i in 1:10000){
    a=rnorm(75,1.1,1)
    b=rnorm(75,1.2,1)
    c=rnorm(75,1.3,1)
    d=rnorm(75,1.4,1)
    e=rnorm(75,1.5,1)
    x<-data.frame(a,b,c,d,e)
    xnew<-gather(x,var,value)
    memeda[i,1]<-anova(lm(value~var,data=xnew))$"Pr(>F)"[1]
    with<-with(xnew,{
        fit<-aov(value~var)
        summary(fit)
        TukeyHSD(fit)})
    memeda[i,2]<-with$var[4,4]
}
plot(memeda)
abline(h=0.05)
abline(v=0.05)
library(tidyr)
a=rnorm(75,1.1,1)
b=rnorm(75,1.2,1)
c=rnorm(75,1.3,1)
d=rnorm(75,1.4,1)
e=rnorm(75,1.5,1)
x<-data.frame(a,b,c,d,e)
xnew<-gather(x,var,value)
fit <- aov(value~var, data = xnew)
summaary(fit)
summary(fit)
TukeyHSD(fit)
